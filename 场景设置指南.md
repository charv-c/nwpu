# Unity 2D 大富翁游戏 - 场景设置指南

## 快速设置步骤

### 第一步：创建基础场景结构

1. **创建空场景**
   - 打开Unity，创建新的2D场景
   - 保存场景为 "MonopolyGame"

2. **创建主管理器对象**
   ```
   - 右键Hierarchy → Create Empty → 重命名为 "GameManager"
   - 添加以下组件：
     * GameManager 脚本
     * BoardManager 脚本
   ```

3. **创建游戏板生成器**
   ```
   - 右键Hierarchy → Create Empty → 重命名为 "BoardGenerator"
   - 添加 BoardGenerator 脚本
   ```

4. **创建UI管理器**
   ```
   - 右键Hierarchy → Create Empty → 重命名为 "UIManager"
   - 添加 UIManager 脚本
   ```

5. **创建玩家棋子**
   ```
   - 右键Hierarchy → Create Empty → 重命名为 "PlayerChess"
   - 添加 Chess 脚本
   - 添加 SpriteRenderer 组件
   - 设置一个简单的圆形精灵
   ```

6. **创建骰子对象**
   ```
   - 右键Hierarchy → Create Empty → 重命名为 "Dice"
   - 添加 Dice 脚本
   - 添加 Image 组件（用于UI显示）
   - 确保Image组件在Canvas下
   ```

### 第二步：设置UI界面

1. **创建Canvas**
   ```
   - 右键Hierarchy → UI → Canvas
   - 设置Canvas Scaler为 "Scale With Screen Size"
   - 参考分辨率设置为 1920x1080
   ```

2. **创建主菜单面板**
   ```
   - 在Canvas下创建空对象 → 重命名为 "MainMenuPanel"
   - 添加以下UI元素：
     * 标题文本 (TextMeshPro)
     * 开始游戏按钮 (Button)
     * 设置按钮 (Button)
     * 退出按钮 (Button)
   ```

3. **创建游戏面板**
   ```
   - 在Canvas下创建空对象 → 重命名为 "GamePanel"
   - 添加以下UI元素：
     * 掷骰子按钮 (Button)
     * 返回主菜单按钮 (Button)
     * 骰子结果文本 (TextMeshPro)
   ```

4. **创建设置面板**
   ```
   - 在Canvas下创建空对象 → 重命名为 "SettingsPanel"
   - 添加以下UI元素：
     * 音效开关 (Toggle)
     * 音乐音量滑块 (Slider)
     * 关闭按钮 (Button)
   ```

### 第三步：配置组件

#### GameManager 配置
```
- Max Board Points: 20
- Enable Sound: true
- Roll Dice Button: 拖拽游戏面板中的掷骰子按钮
- Dice Result Text: 拖拽骰子结果文本
- Player Chess: 拖拽PlayerChess对象
- Dice Object: 拖拽Dice对象
```

#### BoardGenerator 配置
```
- Board Size: 20
- Board Size X: 10
- Board Size Y: 10
- Generate On Start: true
- Show Numbers: true
- Board Color: 白色
```

#### UIManager 配置
```
- Main Menu Panel: 拖拽主菜单面板
- Start Game Button: 拖拽开始游戏按钮
- Settings Button: 拖拽设置按钮
- Quit Button: 拖拽退出按钮
- Game Panel: 拖拽游戏面板
- Roll Dice Button: 拖拽掷骰子按钮
- Back To Menu Button: 拖拽返回主菜单按钮
- Dice Result Text: 拖拽骰子结果文本
- Settings Panel: 拖拽设置面板
- Sound Toggle: 拖拽音效开关
- Music Volume Slider: 拖拽音乐音量滑块
- Close Settings Button: 拖拽关闭设置按钮
- Player Chess: 拖拽PlayerChess对象
```

#### Dice 配置
```
- Roll Duration: 1.5
- Min Roll Count: 8
- Max Roll Count: 15
- Dice Image: 拖拽Image组件
- Dice Text: 拖拽TextMeshPro组件（可选）
- Dice Audio Source: 添加AudioSource组件
- Roll Sound: 拖拽滚动音效文件（可选）
- Stop Sound: 拖拽停止音效文件（可选）
```

**重要：Dice Image 设置方法**

1. **创建Dice UI对象**
   ```
   - 在Canvas下创建UI → Image → 重命名为 "DiceImage"
   - 设置合适的大小（建议100x100）
   - 设置位置在游戏面板中
   ```

2. **设置Dice Image引用**
   ```
   - 选择Dice对象
   - 在Dice组件的Dice Image字段中
   - 拖拽刚才创建的DiceImage对象
   ```

3. **验证设置**
   ```
   - 确保DiceImage对象有Image组件
   - 确保DiceImage在Canvas下（UI层级）
   - 确保DiceImage可见且大小合适
   ```

4. **常见问题**
   ```
   - 如果Dice Image为空：检查是否拖拽了正确的Image对象
   - 如果骰子不显示：确保Image组件启用，检查diceSprites列表
   - 如果位置不对：调整DiceImage在Canvas中的位置
   ```

#### Chess 配置
```
- Move Speed: 5
- Jump Height: 0.5
- Jump Duration: 0.3
- Trail Effect: 拖拽拖尾效果预制体（可选）
- Move Particles: 拖拽粒子系统（可选）
```

### 第四步：设置骰子图片

1. **准备骰子图片**
   - 准备6张骰子图片（1-6点）
   - 导入到Unity项目中
   - 设置Texture Type为 "Sprite (2D and UI)"

2. **配置Dice组件**
   - 在Dice对象的Dice Sprites列表中
   - 按顺序添加6张骰子图片（索引0-5对应点数1-6）

3. **测试骰子显示**
   - 如果骰子不显示，可以在Dice脚本中调用CreateDefaultDiceSprites()方法
   - 检查Console窗口的调试信息

### 第五步：设置音效（可选）

1. **准备音效文件**
   - 准备骰子滚动音效
   - 准备骰子停止音效
   - 导入到Unity项目中

2. **配置AudioSource**
   - 在Dice对象上添加AudioSource组件
   - 将音效文件拖拽到Dice组件的对应字段

### 第六步：测试游戏

1. **运行场景**
   - 点击Play按钮
   - 检查主菜单是否正常显示

2. **测试基本功能**
   - 点击开始游戏
   - 测试掷骰子功能
   - 检查玩家移动
   - 测试UI按钮功能

3. **调试问题**
   - 检查Console窗口的错误信息
   - 确认所有组件已正确配置
   - 验证UI元素已正确连接

## 界面显示逻辑说明

### 界面切换规则
- **主菜单**: 显示主菜单面板，隐藏其他界面和玩家棋子
- **游戏界面**: 显示游戏面板，隐藏其他界面，显示玩家棋子
- **设置界面**: 覆盖显示设置面板，不影响其他界面状态

### 玩家棋子显示
- 只在游戏进行时显示
- 在主菜单和设置界面时自动隐藏

## 方形路线说明

### 路线生成规则
- 游戏板按方形路线生成
- 点位均匀分布在四条边上
- 从底边开始，按顺时针方向编号

### 自定义路线
- 可以调整boardSizeX和boardSizeY改变方形大小
- 可以调整boardSize改变点位数量

## 常见问题解决

### 问题1：玩家不移动
**解决方案：**
- 检查BoardManager中的boardPoints列表是否为空
- 确认BoardGenerator已正确生成游戏板
- 验证Dice组件的事件回调是否正确设置

### 问题2：UI按钮无响应
**解决方案：**
- 检查UIManager中的按钮引用是否正确
- 确认Canvas的EventSystem存在
- 验证按钮的OnClick事件已正确设置

### 问题3：游戏板不显示
**解决方案：**
- 检查BoardGenerator的generateOnStart设置
- 确认Camera设置正确（2D场景）
- 验证游戏板尺寸设置合理

### 问题4：骰子动画不播放
**解决方案：**
- 检查Dice组件的diceSprites列表是否为空
- 确认Image组件已正确设置
- 验证rollDuration设置合理
- 查看Console窗口的调试信息

### 问题5：界面显示混乱
**解决方案：**
- 检查UIManager中的界面引用是否正确
- 确认HideAllPanels()方法正常工作
- 验证SetPanelActive()方法正确设置界面状态

## 优化建议

1. **性能优化**
   - 使用对象池管理频繁创建的对象
   - 优化UI更新频率
   - 合理设置动画时长

2. **用户体验**
   - 添加过渡动画
   - 优化按钮反馈效果
   - 添加音效和视觉反馈

3. **代码结构**
   - 使用事件系统解耦组件
   - 添加错误处理机制
   - 实现配置系统

## 扩展功能

1. **多人游戏**
   - 添加多个玩家棋子
   - 实现回合制系统
   - 添加玩家选择界面

2. **特殊格子**
   - 实现奖励/惩罚格子
   - 添加机会/命运卡片
   - 创建传送门效果

3. **游戏模式**
   - 添加时间限制模式
   - 实现目标达成模式
   - 创建自定义规则

## 发布设置

1. **构建设置**
   - 设置目标平台
   - 配置分辨率
   - 优化资源大小

2. **性能测试**
   - 测试不同设备性能
   - 优化内存使用
   - 检查帧率表现

3. **用户体验测试**
   - 测试不同屏幕尺寸
   - 验证触摸操作
   - 检查无障碍功能
